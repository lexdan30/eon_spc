!function(e){e.fn.extend({tableExport:function(t){var n={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false",all:!0,json_data:[]},i=(t=e.extend(n,t),this);if("csv"==n.type||"txt"==n.type){var o=0,a="";e(i).find("thead").find("tr").each((function(){a+="\n",e(this).filter(":visible").find("th").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(a+='"'+v(e(this))+'"'+n.separator,o+=1)})),a=e.trim(a),a=e.trim(a).substring(0,a.length-1)})),1==n.all?e.each(n.json_data,(function(t,i){a+="\n";var s=0;for(var l in i)s<o&&(null===i[l]&&(i[l]=" "),a+='"'+i[l]+'"'+n.separator),s+=1;a=e.trim(a).substring(0,a.length-1)})):e(i).find("tbody").find("tr").each((function(){a+="\n",e(this).filter(":visible").find("td").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(a+='"'+v(e(this))+'"'+n.separator)})),a=e.trim(a).substring(0,a.length-1)})),console.log(a),"true"==n.consoleLog&&console.log(a);var s="base64,"+e.base64.encode(a);window.open("data:application/"+n.type+";filename=exportData;"+s)}else if("sql"==n.type){a="INSERT INTO `"+n.tableName+"` (";e(i).find("thead").find("tr").each((function(){e(this).filter(":visible").find("th").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(a+="`"+v(e(this))+"`,")})),a=e.trim(a),a=e.trim(a).substring(0,a.length-1)})),a+=") VALUES ",e(i).find("tbody").find("tr").each((function(){a+="(",e(this).filter(":visible").find("td").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(a+='"'+v(e(this))+'",')})),a=e.trim(a).substring(0,a.length-1),a+="),"})),a=e.trim(a).substring(0,a.length-1),a+=";","true"==n.consoleLog&&console.log(a);s="base64,"+e.base64.encode(a);window.open("data:application/sql;filename=exportData;"+s)}else if("json"==n.type){var l=[];e(i).find("thead").find("tr").each((function(){var t=[];e(this).filter(":visible").find("th").each((function(i,o){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(i)&&t.push(v(e(this)))})),l.push(t)}));var d=[];e(i).find("tbody").find("tr").each((function(){var t=[];e(this).filter(":visible").find("td").each((function(i,o){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(i)&&t.push(v(e(this)))})),d.push(t)}));var r=[];r.push({header:l,data:d}),"true"==n.consoleLog&&console.log(JSON.stringify(r));s="base64,"+e.base64.encode(JSON.stringify(r));window.open("data:application/json;filename=exportData;"+s)}else if("xml"==n.type){var f='<?xml version="1.0" encoding="utf-8"?>';f+="<tabledata><fields>",e(i).find("thead").find("tr").each((function(){e(this).filter(":visible").find("th").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(f+="<field>"+v(e(this))+"</field>")}))})),f+="</fields><data>";var c=1;e(i).find("tbody").find("tr").each((function(){f+='<row id="'+c+'">';var t=0;e(this).filter(":visible").find("td").each((function(i,o){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(i)&&(f+="<column-"+t+">"+v(e(this))+"</column-"+t+">"),t++})),c++,f+="</row>"})),f+="</data></tabledata>","true"==n.consoleLog&&console.log(f);s="base64,"+e.base64.encode(f);window.open("data:application/xml;filename=exportData;"+s)}else if("excel"==n.type||"doc"==n.type||"powerpoint"==n.type){o=0;var h="<table>";if(e(i).find("thead").find("tr").each((function(){h+="<tr>",e(this).filter(":visible").find("th").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(h+="<td>"+v(e(this))+"</td>",o+=1)})),h+="</tr>"})),1==n.all)e.each(n.json_data,(function(e,t){h+="<tr>";var n=0;for(var i in t)n<o&&(null===t[i]&&(t[i]=" "),h+="<td>"+t[i]+"</td>"),n+=1;h+="</tr>"}));else{c=1;e(i).find("tbody").find("tr").each((function(){h+="<tr>";e(this).filter(":visible").find("td").each((function(t,i){"none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)&&(h+="<td>"+v(e(this))+"</td>")})),c++,h+="</tr>"}))}h+="</table>",console.log(h),"true"==n.consoleLog&&console.log(h);var p="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+n.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";p+="<head>",p+="\x3c!--[if gte mso 9]>",p+="<xml>",p+="<x:ExcelWorkbook>",p+="<x:ExcelWorksheets>",p+="<x:ExcelWorksheet>",p+="<x:Name>",p+="{worksheet}",p+="</x:Name>",p+="<x:WorksheetOptions>",p+="<x:DisplayGridlines/>",p+="</x:WorksheetOptions>",p+="</x:ExcelWorksheet>",p+="</x:ExcelWorksheets>",p+="</x:ExcelWorkbook>",p+="</xml>",p+="<![endif]--\x3e<meta http-equiv='content-type' content='text/plain; charset=UTF-8'/>",p+="</head>",p+="<body>",p+=h,p+="</body>",p+="</html>";s="base64,"+e.base64.encode(p);window.open("data:application/vnd.ms-"+n.type+";filename=exportData.xls;"+s)}else if("png"==n.type)html2canvas(e(i),{onrendered:function(e){var t=e.toDataURL("image/png");window.open(t)}});else if("pdf"==n.type){var u=new jsPDF("p","pt","a4",!0);u.setFontSize(n.pdfFontSize);var m=n.pdfLeftMargin;e(i).find("thead").find("tr").each((function(){e(this).filter(":visible").find("th").each((function(t,i){if("none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)){var o=m+50*t;u.text(o,20,v(e(this)))}}))}));var x=20,g=1,b=0;e(i).find("tbody").find("tr").each((function(t,i){rowCalc=t+1,rowCalc%26==0&&(u.addPage(),g++,x+=10),b=x+10*rowCalc-280*(g-1),e(this).filter(":visible").find("td").each((function(t,i){if("none"!=e(this).css("display")&&-1==n.ignoreColumn.indexOf(t)){var o=m+50*t;u.text(o,b,v(e(this)))}}))})),u.output("datauri")}function v(e){return"true"==n.htmlContent?content_data=e.html().trim():content_data=e.text().trim(),"true"==n.escape&&(content_data=escape(content_data)),content_data=decodeURIComponent(content_data),content_data}}})}(jQuery);