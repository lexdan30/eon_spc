!function(e,t,n,l){var o="table2excel",a={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0,preserveColors:!0};function s(t,n){this.element=t,this.settings=e.extend({},a,n),this._defaults=a,this._name=o,this.init()}function r(e){return e.filename?e.filename:"table2excel"}s.prototype={init:function(){var t=this;t.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},t.tableRows=[];var n="",l=null;e(t.element).each((function(o,a){var s,r="";e(a).find("tr").not(t.settings.exclude).each((function(o,a){n="",t.settings.preserveColors&&(l=getComputedStyle(a),n+=l&&l.backgroundColor?"background-color: "+l.backgroundColor+";":"",n+=l&&l.color?"color: "+l.color+";":""),r+="<tr style='"+n+"'>",e(a).find("td,th").not(t.settings.exclude).each((function(o,a){n="",t.settings.preserveColors&&(l=getComputedStyle(a),n+=l&&l.backgroundColor?"background-color: "+l.backgroundColor+";":"",n+=l&&l.color?"color: "+l.color+";":"");var s=e(this).attr("rowspan"),i=e(this).attr("colspan");e(a).find(t.settings.exclude).length>0?r+="<td> </td>":(r+="<td",s>0&&(r+=" rowspan='"+s+"' "),i>0&&(r+=" colspan='"+i+"' "),n&&(r+=" style='"+n+"'"),r+=">"+e(a).html()+"</td>")})),r+="</tr>"})),t.settings.exclude_img&&(s=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,r=r.replace(/<img[^>]*>/gi,(function(e){var t=s.exec(e);return null!==t&&t.length>=2?t[2]:""}))),t.settings.exclude_links&&(r=function(e){return e.replace(/<a[^>]*>|<\/a>/gi,"")}(r)),t.settings.exclude_inputs&&(r=function(e){var t=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i;return e.replace(/<input[^>]*>|<\/input>/gi,(function(e){var n=t.exec(e);return null!==n&&n.length>=2?n[2]:""}))}(r)),t.tableRows.push(r)})),t.tableToExcel(t.tableRows,t.settings.name,t.settings.sheetName)},tableToExcel:function(l,o,a){var s,i,c,u=this,x="";for(s in u.format=function(e,t){return e.replace(/{(\w+)}/g,(function(e,n){return t[n]}))},a=void 0===a?"Sheet":a,u.ctx={worksheet:o||"Worksheet",table:l,sheetName:a},x=u.template.head,e.isArray(l)&&Object.keys(l).forEach((function(e){x+=u.template.sheet.head+a+e+u.template.sheet.tail})),x+=u.template.mid,e.isArray(l)&&Object.keys(l).forEach((function(e){x+=u.template.table.head+"{table"+e+"}"+u.template.table.tail})),x+=u.template.foot,l)u.ctx["table"+s]=l[s];if(delete u.ctx.table,-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==navigator.userAgent.indexOf("Trident")&&-1!==navigator.userAgent.indexOf("rv:11"))if("undefined"!=typeof Blob){x=[x=u.format(x,u.ctx)];var d=new Blob(x,{type:"text/html"});t.navigator.msSaveBlob(d,r(u.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(u.format(x,u.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,r(u.settings));else{var m=new Blob([u.format(x,u.ctx)],{type:"application/vnd.ms-excel"});t.URL=t.URL||t.webkitURL,i=t.URL.createObjectURL(m),(c=n.createElement("a")).download=r(u.settings),c.href=i,n.body.appendChild(c),c.click(),n.body.removeChild(c)}return!0}},e.fn.table2excel=function(t){var n=this;return n.each((function(){e.data(n,"plugin_table2excel")||e.data(n,"plugin_table2excel",new s(this,t))})),n}}(jQuery,window,document);